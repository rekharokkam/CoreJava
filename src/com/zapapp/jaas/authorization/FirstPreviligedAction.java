//This is for dynamic permission checking from Programiticallypackage com.zapapp.jaas.authorization;import java.security.PrivilegedAction;import java.security.AccessController;import java.security.AccessControlContext;import javax.security.auth.Subject;import java.security.AccessControlException;import java.security.Principal;import java.util.Iterator;import java.util.Set;public class FirstPreviligedAction implements PrivilegedAction {		public Object run ()	{System.out.println ("INISDE THE RUN METHOD OF FirstPreviligedAction " );						AccessControlContext context = AccessController.getContext();		Subject subject = Subject.getSubject (context);		Set allPrincipals = subject.getPrincipals ();				if ( (null != allPrincipals) && (allPrincipals.size () > 0) )		{			Iterator it = allPrincipals.iterator ();			Principal eachPrincipal = null;						while (it.hasNext ())			{				eachPrincipal = (Principal)it.next ();				if (eachPrincipal.getName ().equalsIgnoreCase ("rekha"))								{					return null;				}			}		}				throw new AccessControlException ("ACCESS IS DENIED");				/*		AccessController.checkPermission (new MyPermission (action) );			return new Integer (0);		*/	}}